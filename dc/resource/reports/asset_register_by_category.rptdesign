<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.2.1.v201209101448 Build &lt;4.2.1.v20120912-1721></property>
    <property name="units">mm</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="PeriodEndId" id="252">
            <text-property name="promptText">PeriodEnd</text-property>
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">293</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Local MySQL" id="248">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.mysql.jdbc.Driver</property>
            <property name="odaURL">jdbc:mysql://localhost:3306/dc</property>
            <property name="odaUser">drcrro</property>
            <encrypted-property name="odaPassword" encryptionID="base64">ZGM=</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="dsCompanyName" id="250">
            <property name="nullsOrdering">nulls lowest</property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">PeriodEndId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">-1</property>
                    <property name="position">1</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">name</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Local MySQL</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">name</property>
                    <property name="nativeName">name</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select company.name
from company INNER JOIN (
	financial_year INNER JOIN period_end ON financial_year.id=period_end.financial_year_id
) ON company.id=financial_year.company_id
where period_end.id=?]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <DataSetParameters>
    <parameter>
      <design:ParameterDefinition>
        <design:inOutMode>In</design:inOutMode>
        <design:attributes>
          <design:identifier>
            <design:name></design:name>
            <design:position>1</design:position>
          </design:identifier>
          <design:nativeDataTypeCode>-1</design:nativeDataTypeCode>
          <design:precision>0</design:precision>
          <design:scale>0</design:scale>
          <design:nullability>Unknown</design:nullability>
        </design:attributes>
      </design:ParameterDefinition>
    </parameter>
  </DataSetParameters>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="dsReport" id="253">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">asset</property>
                    <text-property name="displayName">Asset</text-property>
                </structure>
                <structure>
                    <property name="columnName">reference</property>
                    <text-property name="displayName">Reference</text-property>
                </structure>
                <structure>
                    <property name="columnName">acquisition_date</property>
                    <text-property name="displayName">Acquisition date</text-property>
                </structure>
                <structure>
                    <property name="columnName">disposal_type</property>
                    <text-property name="displayName">Disposal type</text-property>
                </structure>
                <structure>
                    <property name="columnName">disposal_date</property>
                    <text-property name="displayName">Disposal date</text-property>
                </structure>
                <structure>
                    <property name="columnName">opening_cost</property>
                    <text-property name="displayName">At Beginning of period</text-property>
                </structure>
                <structure>
                    <property name="columnName">addition</property>
                    <text-property name="displayName">Additions</text-property>
                </structure>
                <structure>
                    <property name="columnName">transfer_cost</property>
                    <text-property name="displayName">Transfer IN</text-property>
                </structure>
                <structure>
                    <property name="columnName">disposal_cost</property>
                    <text-property name="displayName">Disposal</text-property>
                </structure>
                <structure>
                    <property name="columnName">opening_dep</property>
                    <text-property name="displayName">At Beginning of period</text-property>
                </structure>
                <structure>
                    <property name="columnName">transfer_dep</property>
                    <text-property name="displayName">Transfer IN</text-property>
                </structure>
                <structure>
                    <property name="columnName">disposal_dep</property>
                    <text-property name="displayName">Disposal</text-property>
                </structure>
                <structure>
                    <property name="columnName">dep</property>
                    <text-property name="displayName">P/L charge</text-property>
                </structure>
                <structure>
                    <property name="columnName">closing_cost</property>
                    <text-property name="displayName">At end of period</text-property>
                </structure>
                <structure>
                    <property name="columnName">closing_dep</property>
                    <text-property name="displayName">At end of period</text-property>
                </structure>
                <structure>
                    <property name="columnName">nbv</property>
                    <text-property name="displayName">NBV</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">PeriodEndId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">-1</property>
                    <property name="position">1</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">asset_class</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">category</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">asset</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">reference</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">acquisition_date</property>
                        <property name="dataType">date</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">disposal_type</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">disposal_date</property>
                        <property name="dataType">date</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">opening_cost</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">addition</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">transfer_cost</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">disposal_cost</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">opening_dep</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">transfer_dep</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">disposal_dep</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">dep</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">closing_cost</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">closing_dep</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">nbv</property>
                        <property name="dataType">decimal</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Local MySQL</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">asset_class</property>
                    <property name="nativeName">asset_class</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">category</property>
                    <property name="nativeName">category</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">asset</property>
                    <property name="nativeName">asset</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">reference</property>
                    <property name="nativeName">reference</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">acquisition_date</property>
                    <property name="nativeName">acquisition_date</property>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">disposal_type</property>
                    <property name="nativeName">disposal_type</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">disposal_date</property>
                    <property name="nativeName">disposal_date</property>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">opening_cost</property>
                    <property name="nativeName">opening_cost</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">addition</property>
                    <property name="nativeName">addition</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">transfer_cost</property>
                    <property name="nativeName">transfer_cost</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">disposal_cost</property>
                    <property name="nativeName">disposal_cost</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">12</property>
                    <property name="name">opening_dep</property>
                    <property name="nativeName">opening_dep</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">13</property>
                    <property name="name">transfer_dep</property>
                    <property name="nativeName">transfer_dep</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">14</property>
                    <property name="name">disposal_dep</property>
                    <property name="nativeName">disposal_dep</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">15</property>
                    <property name="name">dep</property>
                    <property name="nativeName">dep</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">16</property>
                    <property name="name">closing_cost</property>
                    <property name="nativeName">closing_cost</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">17</property>
                    <property name="name">closing_dep</property>
                    <property name="nativeName">closing_dep</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">18</property>
                    <property name="name">nbv</property>
                    <property name="nativeName">nbv</property>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select *, (closing_cost - closing_dep) AS nbv FROM (select *,
(opening_cost+addition+transfer_cost+disposal_cost) AS closing_cost,(opening_dep+transfer_dep+disposal_dep+dep) AS closing_dep
FROM (

SELECT c.type AS asset_class, c.name AS category, a.name AS asset, a.reference, a.acquisition_date, a.disposal_type, a.disposal_date,

SUM(IF(t.class='COST' AND tp.end_date < p.from_period, t.amount,0)) AS opening_cost,
SUM(IF(t.class='COST' AND t.type='OPENING' AND a.acquisition_type!='TRANSFER' AND tp.end_date >= p.from_period,t.amount,0)) AS addition,
SUM(IF(t.class='COST' AND t.type='OPENING' AND a.acquisition_type='TRANSFER' AND tp.end_date >= p.from_period,t.amount,0)) AS transfer_cost,
SUM(IF(t.class='COST' AND t.type='CLOSING' AND tp.end_date >= p.from_period,t.amount,0)) as disposal_cost,

SUM(IF(t.class='DEP' AND tp.end_date < p.from_period,-t.amount,0)) AS opening_dep,
SUM(IF(t.class='DEP' AND t.type='OPENING' AND a.acquisition_type='TRANSFER' AND tp.end_date >= p.from_period,-t.amount,0)) AS transfer_dep,
SUM(IF(t.class='DEP' AND t.type='CLOSING' AND tp.end_date >= p.from_period,-t.amount,0)) AS disposal_dep,
SUM(IF(t.class='DEP' AND t.type='CHARGE' AND tp.end_date >= p.from_period,-t.amount,0)) AS dep

FROM
(SELECT fy.company_id AS company_id, CONCAT(YEAR(pa.end_date),'-',MONTH(pa.end_date),'-',1) AS financial_year_start, pa.end_date AS from_period, pb.end_date AS to_period
FROM period_end AS pa INNER JOIN (
	period_end AS pb INNER JOIN financial_year AS fy ON pb.financial_year_id=fy.id
) ON pa.financial_year_id=pb.financial_year_id
WHERE pb.id=?
ORDER BY pa.end_date ASC LIMIT 1) AS p,
fa_asset_category AS c INNER JOIN (
	fa_company_asset_category AS cc INNER JOIN (
		fa_asset AS a INNER JOIN (
			fa_transaction AS t INNER JOIN period_end AS tp ON t.period_end_id=tp.id
		) ON a.id=t.fa_asset_id
	) ON cc.id=a.fa_company_asset_category_id
) ON c.id=cc.fa_asset_category_id

WHERE cc.company_id=p.company_id AND
	tp.end_date <= p.to_period AND
	a.acquisition_date <= p.to_period AND
	(a.disposal_date IS NULL OR a.disposal_date >= p.financial_year_start)

GROUP BY asset_class, category, asset) dta
) dtb ORDER BY asset_class DESC, category ASC, acquisition_date DESC, asset ASC;
]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <DataSetParameters>
    <parameter>
      <design:ParameterDefinition>
        <design:inOutMode>In</design:inOutMode>
        <design:attributes>
          <design:identifier>
            <design:name></design:name>
            <design:position>1</design:position>
          </design:identifier>
          <design:nativeDataTypeCode>-1</design:nativeDataTypeCode>
          <design:precision>0</design:precision>
          <design:scale>0</design:scale>
          <design:nullability>Unknown</design:nullability>
        </design:attributes>
      </design:ParameterDefinition>
    </parameter>
  </DataSetParameters>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <styles>
        <style name="report" id="4">
            <property name="fontFamily">"Arial", sans-serif</property>
            <property name="fontSize">7pt</property>
        </style>
        <style name="my_data" id="476">
            <structure name="numberFormat">
                <property name="category">Currency</property>
                <property name="pattern">#,##0;(#,##0){RoundingMode=HALF_UP}</property>
            </structure>
            <property name="textAlign">right</property>
        </style>
        <style name="report_title" id="477">
            <property name="fontSize">130%</property>
            <property name="fontWeight">bold</property>
        </style>
        <style name="report_subtitle" id="478">
            <property name="fontSize">120%</property>
            <property name="fontWeight">bold</property>
        </style>
        <style name="data_header" id="479">
            <property name="backgroundColor">#E6E6FA</property>
            <property name="fontWeight">bold</property>
        </style>
        <style name="data_label" id="480">
            <property name="fontWeight">bold</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">thick</property>
        </style>
        <style name="data_group" id="481">
            <property name="backgroundColor">#E6E6FA</property>
            <property name="fontWeight">bold</property>
            <property name="fontStyle">normal</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <property name="orientation">landscape</property>
            <property name="rightMargin">0mm</property>
            <page-footer>
                <text id="3">
                    <property name="contentType">html</property>
                    <text-property name="content"><![CDATA[<value-of>new Date()</value-of>]]></text-property>
                </text>
            </page-footer>
        </simple-master-page>
    </page-setup>
    <body>
        <label id="7">
            <property name="style">report_title</property>
            <text-property name="text">Fixed Assets</text-property>
        </label>
        <data id="254">
            <property name="style">report_subtitle</property>
            <property name="marginBottom">10mm</property>
            <structure name="numberFormat">
                <property name="category">Currency</property>
                <property name="pattern">#,##0;(#,##0){RoundingMode=HALF_UP}</property>
            </structure>
            <property name="dataSet">dsCompanyName</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">name</property>
                    <text-property name="displayName">name</text-property>
                    <expression name="expression" type="javascript">dataSetRow["name"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">name</property>
        </data>
    </body>
</report>
